import{c as $,w as B,x as W,j as a,S as G,d as K,n as O,y as Y,u as H,Q as J,p as X,z as U,e as V,f as I,M as y,A as Z,r as ee,q as te,v as ae,E as se,F as z,B as ie}from"./index-CgwAo6pj.js";function oe(){const i=$.c(10),e=B();let t;i[0]===Symbol.for("react.memo_cache_sentinel")?(t=["archived-threads"],i[0]=t):t=i[0];let u;i[1]!==e?(u={queryKey:t,queryFn:()=>e.listArchivedThreads(),staleTime:J.FIVE_SECONDS},i[1]=e,i[2]=u):u=i[2];const{data:v,isLoading:d,isError:r}=W(u);let c;i[3]!==v?(c=v===void 0?[]:v,i[3]=v,i[4]=c):c=i[4];const o=c;let l;i[5]===Symbol.for("react.memo_cache_sentinel")?(l=a.jsx(X,{slug:"data-controls"}),i[5]=l):l=i[5];let n;return i[6]!==o||i[7]!==r||i[8]!==d?(n=a.jsx(G,{title:l,children:a.jsx(K,{className:"gap-2",children:a.jsx(K.Content,{children:a.jsx(re,{archivedThreads:o,isLoading:d,isError:r})})})}),i[6]=o,i[7]=r,i[8]=d,i[9]=n):n=i[9],n}function re(i){const e=$.c(14),{archivedThreads:t,isLoading:u,isError:v}=i,d=O(),r=Y(),c=H();let o;e[0]!==d||e[1]!==r||e[2]!==c?(o=s=>{if(c==="electron"){d(`/local/${U(s)}`);return}r(s)},e[0]=d,e[1]=r,e[2]=c,e[3]=o):o=e[3];const l=o;if(u){let s;return e[4]===Symbol.for("react.memo_cache_sentinel")?(s=a.jsx("div",{className:"px-1.5 py-1",children:a.jsx(V,{children:a.jsx(I,{label:a.jsx(y,{id:"settings.dataControls.archivedChats.loading",defaultMessage:"Loading archived chats…",description:"Loading state label for archived chats list"}),control:null})})}),e[4]=s):s=e[4],s}if(v){let s;return e[5]===Symbol.for("react.memo_cache_sentinel")?(s=a.jsx("div",{className:"px-1.5 py-1",children:a.jsx(V,{children:a.jsx(I,{label:a.jsx(y,{id:"settings.dataControls.archivedChats.error",defaultMessage:"Could not load archived chats.",description:"Error state label for archived chats list"}),control:null})})}),e[5]=s):s=e[5],s}if(t.length===0){let s;return e[6]===Symbol.for("react.memo_cache_sentinel")?(s=a.jsx("div",{className:"px-1.5 py-1",children:a.jsx(V,{children:a.jsx(I,{label:a.jsx(y,{id:"settings.dataControls.archivedChats.empty",defaultMessage:"No archived chats.",description:"Empty state label for archived chats list"}),control:null})})}),e[6]=s):s=e[6],s}let n;if(e[7]!==t||e[8]!==l){let s;e[10]!==l?(s=m=>{const f=U(m.id);return a.jsx(ne,{archivedThread:m,conversationId:f,onViewConversation:l},m.id)},e[10]=l,e[11]=s):s=e[11],n=t.map(s),e[7]=t,e[8]=l,e[9]=n}else n=e[9];let h;return e[12]!==n?(h=a.jsx("div",{className:"px-1.5 py-1",children:a.jsx(V,{className:"max-h-[min(80vh)] overflow-y-auto",children:n})}),e[12]=n,e[13]=h):h=e[13],h}function ne(i){const e=$.c(62),{archivedThread:t,conversationId:u,onViewConversation:v}=i,d=B(),r=Z(),c=ee(),o=te();let l;e[0]!==t.id?(l=["unarchive-thread",t.id],e[0]=t.id,e[1]=l):l=e[1];let n;e[2]!==d||e[3]!==u?(n=async()=>d.unarchiveConversation(u),e[2]=d,e[3]=u,e[4]=n):n=e[4];let h;e[5]!==t.id||e[6]!==r?(h=async()=>{await r.cancelQueries({queryKey:["archived-threads"]});const x=r.getQueryData(["archived-threads"])??[];return r.setQueryData(["archived-threads"],x.filter(w=>w.id!==t.id)),{previousThreads:x}},e[5]=t.id,e[6]=r,e[7]=h):h=e[7];let s;e[8]!==o||e[9]!==r||e[10]!==c?(s=(x,w,A)=>{A?.previousThreads&&r.setQueryData(["archived-threads"],A.previousThreads),c.danger(o.formatMessage({id:"settings.dataControls.archivedChats.unarchiveError",defaultMessage:"Failed to unarchive chat",description:"Error message when unarchiving a chat"}))},e[8]=o,e[9]=r,e[10]=c,e[11]=s):s=e[11];let m;e[12]!==t.id||e[13]!==v||e[14]!==c?(m=()=>{const x=w=>a.jsx("button",{className:"text-token-link hover:underline underline-offset-2",type:"button",onClick:()=>{v(t.id)},children:w});c.info(a.jsx(y,{id:"settings.dataControls.archivedChats.unarchiveSuccess",defaultMessage:"Unarchived thread. <viewNowLink>View now</viewNowLink>",description:"Success toast after unarchiving a chat",values:{viewNowLink:x}}),{id:`unarchive-thread-${t.id}`})},e[12]=t.id,e[13]=v,e[14]=c,e[15]=m):m=e[15];let f;e[16]!==r?(f=()=>{r.invalidateQueries({queryKey:["archived-threads"]})},e[16]=r,e[17]=f):f=e[17];let k;e[18]!==l||e[19]!==n||e[20]!==h||e[21]!==s||e[22]!==m||e[23]!==f?(k={mutationKey:l,mutationFn:n,onMutate:h,onError:s,onSuccess:m,onSettled:f},e[18]=l,e[19]=n,e[20]=h,e[21]=s,e[22]=m,e[23]=f,e[24]=k):k=e[24];const p=ae(k);let D;e[25]!==t.preview?(D=se(t.preview).trim(),e[25]=t.preview,e[26]=D):D=e[26];const L=D;let j,g,C,F;if(e[27]!==t.createdAt||e[28]!==t.cwd||e[29]!==t.path||e[30]!==t.updatedAt||e[31]!==o){const x=new Date(Number(t.updatedAt)*1e3),w=new Date(Number(t.createdAt)*1e3),A=Number.isFinite(x.getTime())?x:Number.isFinite(w.getTime())?w:null;let R;e[36]!==t.cwd||e[37]!==t.path?(R=z(t.cwd)??z(t.path),e[36]=t.cwd,e[37]=t.path,e[38]=R):R=e[38],C=R,g=A!=null,j=g?o.formatDate(A,{year:"numeric",month:"short",day:"numeric"}):"",F=g?o.formatTime(A,{hour:"numeric",minute:"2-digit"}):"",e[27]=t.createdAt,e[28]=t.cwd,e[29]=t.path,e[30]=t.updatedAt,e[31]=o,e[32]=j,e[33]=g,e[34]=C,e[35]=F}else j=e[32],g=e[33],C=e[34],F=e[35];const Q=F;let b;e[39]!==L?(b=L.length>0?L:a.jsx(y,{id:"settings.dataControls.archivedChats.untitled",defaultMessage:"Untitled chat",description:"Fallback title for an archived chat"}),e[39]=L,e[40]=b):b=e[40];let S;e[41]!==b?(S=a.jsx("div",{className:"truncate text-base font-medium",children:b}),e[41]=b,e[42]=S):S=e[42];let N;e[43]!==j||e[44]!==g||e[45]!==C||e[46]!==Q?(N=g?C?a.jsx(y,{id:"settings.dataControls.archivedChats.dateTimeWithRepo",defaultMessage:"{date}, {time} • {repo}",description:"Date, time, and repo name for an archived chat",values:{date:j,time:Q,repo:C}}):a.jsx(y,{id:"settings.dataControls.archivedChats.dateTime",defaultMessage:"{date}, {time}",description:"Date and time for an archived chat",values:{date:j,time:Q}}):null,e[43]=j,e[44]=g,e[45]=C,e[46]=Q,e[47]=N):N=e[47];let T;e[48]!==N?(T=a.jsx("div",{className:"mt-1 flex min-w-0 flex-col gap-0.5 text-sm",children:a.jsx("div",{className:"text-token-text-secondary truncate",children:N})}),e[48]=N,e[49]=T):T=e[49];let M;e[50]!==S||e[51]!==T?(M=a.jsxs("div",{className:"text-token-text-primary min-w-0 flex-1 text-left",children:[S,T]}),e[50]=S,e[51]=T,e[52]=M):M=e[52];let _;e[53]!==p?(_=()=>{p.isPending||p.mutate()},e[53]=p,e[54]=_):_=e[54];let q;e[55]===Symbol.for("react.memo_cache_sentinel")?(q=a.jsx(y,{id:"settings.dataControls.archivedChats.unarchive",defaultMessage:"Unarchive",description:"Button label to unarchive a chat"}),e[55]=q):q=e[55];let E;e[56]!==_||e[57]!==p.isPending?(E=a.jsx(ie,{className:"shrink-0",color:"secondary",size:"toolbar",disabled:p.isPending,loading:p.isPending,onClick:_,children:q}),e[56]=_,e[57]=p.isPending,e[58]=E):E=e[58];let P;return e[59]!==M||e[60]!==E?(P=a.jsxs("div",{className:"hover:bg-token-list-hover-background flex w-full items-center justify-between gap-3 px-4 py-3",children:[M,E]}),e[59]=M,e[60]=E,e[61]=P):P=e[61],P}export{oe as DataControlsSettings};
//# sourceMappingURL=data-controls-BztS6FgZ.js.map
